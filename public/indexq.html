<!DOCTYPE html>
<html>
<head>
  <title>WS example</title>
  <link rel="stylesheet" type="text/css" href="./stylesheets/style.css">

</head>

<body>
  <h2>Socket message response: </h2>
  <pre id="response"></pre>
  <hr/>
  <ul>
  <li><div id="watcher">
  
    <script>
  

  var btc_div = document.getElementById('watcher').innerHTML;
  var parsedPrice = JSON.parse(prices);
  btc_div.innerText = "EUR:"+parsedPrice.EUR+" USD:"+parsedPrice.USD;

</script>
  </div></li>
  <li><div id="watcher">
    
  </div></li>
  <li><div id="watcher">
    
  </div></li>
  </ul>
  <script>

  // Extremely simplified here, no error handling or anything
document.body.onload = function() {

    'use strict';

  // First the socket requesta
  function socketExample() {
    console.log('Creating socket');
    let socket = new WebSocket('ws://localhost:8080/');
    socket.onopen = function() {

      console.log('Socket open.');
      socket.send(JSON.stringify({message: 'What is the meaning of life, the universe and everything?'}));
      console.log('Message sent.')
    };
    socket.onmessage = function(message) {

      console.log('Socket server message', message);
      let data = JSON.parse(message.data);
      document.getElementById('response').innerHTML = JSON.stringify(data, null, 2);
    };

      
  }


  // Call them both;

  socketExample();
  postExample();

  }
  </script>

  
  <!-- <script src="http://localhost:8080/server.js" type="text/javascript"></script> -->
</body>
</html>

